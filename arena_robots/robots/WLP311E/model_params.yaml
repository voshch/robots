# ------------------------------------------------------------
#  Sensor & costmap config
# ------------------------------------------------------------
observation_sources_string: lidar   # nav2_costmap_2d 仍需要串行参数
observation_sources:
  - lidar
observation_sources_dict:
  lidar:
    topic: ${namespace}/lidar
    max_obstacle_height: 2.0
    clearing: true
    marking: true
    data_type: LaserScan

# ------------------------------------------------------------
#  Stop-polygon (示例安全区)
# ------------------------------------------------------------
polygons:
  - StopPolygon
polygons_dict:
  StopPolygon:
    type: polygon
    points: "[ [0.1, 0.1], [0.1, -0.1], [-0.1, -0.1], [-0.1, 0.1] ]"
    action_type: stop
    min_points: 4
    visualize: true
    polygon_pub_topic: polygon_stop
    enabled: true

# ------------------------------------------------------------
#  Planner plugin
# ------------------------------------------------------------
planner_plugins:
  - GridBased
planner_plugins_dict:
  GridBased:
    plugin: nav2_navfn_planner/NavfnPlanner
    tolerance: 0.5
    use_astar: false
    allow_unknown: true

# ------------------------------------------------------------
#  Robot footprint (保持方形 20 cm × 20 cm；有需要请按实测改大)
# ------------------------------------------------------------
footprint: "[ [0.1, 0.1], [0.1, -0.1], [-0.1, -0.1], [-0.1, 0.1] ]"

# ------------------------------------------------------------
#  Frames
# ------------------------------------------------------------
robot_base_frame: base
robot_odom_frame: odom

# ------------------------------------------------------------
#  Discrete / continuous action sets (用于 RL / 多机器人任务)
# ------------------------------------------------------------
actions:
  continuous:
    linear_range:  [ -2.0,  2.0 ]
    angular_range: [ -4.0,  4.0 ]
  discrete:
    - { name: move_forward,       linear:  0.30, angular:  0.00 }
    - { name: move_backward,      linear: -0.15, angular:  0.00 }
    - { name: turn_left,          linear:  0.15, angular:  0.35 }
    - { name: turn_right,         linear:  0.15, angular: -0.35 }
    - { name: turn_strong_left,   linear:  0.00, angular:  0.75 }
    - { name: turn_strong_right,  linear:  0.00, angular: -0.75 }
    - { name: stop,               linear:  0.00, angular:  0.00 }

# ------------------------------------------------------------
#  Kinematics
# ------------------------------------------------------------
is_holonomic: false

# ------------------------------------------------------------
#  Laser parameters
# ------------------------------------------------------------
laser:
  angle:
    min:      -2.35619
    max:       2.35619
    increment: 0.00654497222
  num_beams:   720
  range:       30.0
  update_rate: 10

# ------------------------------------------------------------
#  Robot-specific constants
# ------------------------------------------------------------
robot_model: WLP311E
robot_radius: 0.40         # FIXME: 实测包络半径 (m)
robot_sensor_frame: lidar
z_offset: 0.29
